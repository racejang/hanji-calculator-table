<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>한지 평량·돈 환산 표 생성기</title>
<style>
  :root{ --bg:#f9fafb; --card:#ffffff; --muted:#555; --text:#222; --acc:#1d7a5c; --grid:#ddd; }
  *{box-sizing:border-box}
  body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,Arial,sans-serif; background:var(--bg); color:var(--text);}
  .wrap{max-width:1100px; margin:32px auto; padding:0 16px}
  .notice{background:#eef3f7; border:1px solid #d5dce3; color:#333; padding:10px 14px; border-radius:8px; font-size:14px; display:flex; gap:8px; align-items:center; margin-bottom:16px}
  .card{background:var(--card); border:1px solid #ccc; border-radius:10px; box-shadow:0 4px 12px rgba(0,0,0,.05)}
  .head{padding:18px 20px 10px; border-bottom:1px solid #eee}
  .head h1{margin:0; font-size:20px}
  .body{padding:20px}
  .grid{display:grid; gap:16px}
  @media (min-width:880px){ .grid{grid-template-columns:1.1fr 1fr} }
  .field{display:flex; flex-direction:column; gap:6px}
  label{font-size:13px; color:var(--muted)}
  input[type="text"]{background:#fff; border:1px solid #ccc; color:#text; padding:10px; border-radius:6px; font-size:16px; outline:none;}
  input[type="text"]:focus{border-color:var(--acc); box-shadow:0 0 0 3px rgba(29,122,92,.15)}
  .hint{font-size:12px; color:#777}
  .row{display:flex; gap:12px}
  .row .field{flex:1}
  .btn{background:var(--acc); color:#fff; border:none; padding:10px 14px; border-radius:6px; font-weight:700; cursor:pointer; font-size:15px;}
  .btn.secondary{background:#f2f4f6; color:#333; border:1px solid #ccc}
  /* 버튼을 입력칸 폭에 맞게 */
  .actions {
    display: grid;
    grid-template-columns: 1fr;
    gap: 10px;
  }
  .actions .btn { width: 100%; }
  /* 안내문 */
  .note {
    font-size: 12px;
    color: #777;
    margin-top: 6px;
  }
  .kpis{display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px; margin-top:10px}
  .kpi{background:#f9f9f9; border:1px solid #ddd; border-radius:6px; padding:12px}
  .kpi .v{font-weight:700; font-size:18px}
  table{width:100%; border-collapse:collapse}
  th,td{padding:8px 10px; border:1px solid #ccc}
  thead th{background:#f2f4f6; font-weight:700}
  tbody tr:hover td{background:#f9fbfc}
  .tbl{border:1px solid #ccc; border-radius:6px; overflow:hidden; background:#fff}
  .two{display:grid; gap:16px}
  @media (min-width:880px){ .two{grid-template-columns:1fr 1fr} }
  .foot{padding:14px 20px; font-size:12px; color:#555; background:#f2f4f6}
</style>
</head>
<body>
<div class="wrap">
  <div class="notice">
    <span>ℹ️</span>
    <div>숫자만 입력하세요. 단위는 <b>cm</b> 기준이며, 계산은 <b>1장</b> 기준입니다.</div>
  </div>

  <div class="card">
    <div class="head"><h1>한지 평량·돈 환산 표 생성기</h1></div>
    <div class="body grid">
      <!-- 좌측 입력 -->
      <section>
        <div class="row">
          <div class="field">
            <label>가로 길이(cm)</label>
            <input id="w" type="text" inputmode="decimal" placeholder="예: 63.0" />
            <div class="hint">숫자만 입력</div>
          </div>
          <div class="field">
            <label>세로 길이(cm)</label>
            <input id="h" type="text" inputmode="decimal" placeholder="예: 93.0" />
            <div class="hint">숫자만 입력</div>
          </div>
        </div>
        <div class="actions" style="margin-top:12px">
          <button class="btn" id="calc">계산하기</button>
          <button class="btn secondary" id="csv">CSV 내보내기</button>
          <div class="note">가로·세로 길이를 입력한 뒤 <b>계산하기</b>버튼을 눌러야 값이 반영됩니다.</div>
        </div>
        <div class="kpis" id="kpis" style="display:none">
          <div class="kpi"><div class="v" id="area">0.0000</div><div>면적 (㎡)</div></div>
          <div class="kpi"><div class="v" id="sheets">1</div><div>계산 기준(장)</div></div>
        </div>
      </section>

      <!-- 우측 계산식 + 사용팁 -->
      <section>
        <div class="kpi" style="margin-bottom:12px">
          <div style="font-weight:700; margin-bottom:6px">계산식</div>
          <div style="line-height:1.6; font-size:13px; color:#555">
            • 면적(㎡) = 가로(cm) × 세로(cm) ÷ 10,000<br/>
            • 질량(g) = 평량(g/㎡) × 면적(㎡)<br/>
            • 평량(g/㎡) = (돈 × 3.75) ÷ 면적(㎡)
          </div>
        </div>
        <div class="kpi">
          <div style="font-weight:700; margin-bottom:6px">사용 팁</div>
          <div style="line-height:1.6; font-size:13px; color:#555">
            • '가로 길이'와 '세로 길이'를 숫자만 입력합니다.<br/>
            • ‘계산하기’ 버튼을 누르면 환산 표가 자동 생성됩니다.<br/>
            • CSV 내보내기로 엑셀에서 바로 열 수 있습니다.<br/>
            • 반올림: 소수 첫째 자리(0.1 g)로 표시.
          </div>
        </div>
      </section>

      <!-- 결과 표 -->
      <section class="two" style="grid-column:1/-1">
        <div class="tbl">
          <table id="tblBasisToMass">
            <thead>
              <tr><th colspan="2" id="basisTitle">평량(g/㎡) → 질량(g)</th></tr>
              <tr><th>평량(g/㎡)</th><th>질량(g)</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="tbl">
          <table id="tblDonToBasis">
            <thead>
              <tr><th colspan="2" id="donBasisTitle">돈(몬메) → 평량(g/㎡)</th></tr>
              <tr><th>돈(몬메)</th><th>평량(g/㎡)</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </div>
    <div class="foot">
      © 국립문화유산연구원 복원기술연구실 2025 — 표시값은 이상적 모델에 기반합니다.
    </div>
  </div>
</div>

<script>
(function(){
  const $  = s=>document.querySelector(s);
  const toNum = x => Number(String(x).replace(/[^\d.-]/g,''));
  const round1 = x => Math.round((x + Number.EPSILON) * 10) / 10;
  const round4 = x => Math.round((x + Number.EPSILON) * 10000) / 10000;

  const wEl = $('#w'), hEl = $('#h');
  const areaEl = $('#area'), kpis = $('#kpis'), sheetsEl = $('#sheets');
  const basisTBody = $('#tblBasisToMass tbody'), donBasisTBody = $('#tblDonToBasis tbody');
  const basisTitle = $('#basisTitle'), donBasisTitle = $('#donBasisTitle');

  wEl.value = '63.0'; 
  hEl.value = '93.0'; 

  function calc(){
    const w = toNum(wEl.value), h = toNum(hEl.value);
    if(!isFinite(w) || !isFinite(h) || w<=0 || h<=0){ alert('가로/세로를 올바르게 입력'); return; }

    basisTitle.textContent = '평량(g/㎡) → 질량(g)';
    donBasisTitle.textContent= '돈(몬메) → 평량(g/㎡)';

    const area = (w*h)/10000; 
    areaEl.textContent = round4(area).toFixed(4);
    sheetsEl.textContent = '1';
    kpis.style.display = 'grid';

    basisTBody.innerHTML = '';
    for(let bw=5; bw<=80; bw+=5){
      const mass = round1(bw * area);
      basisTBody.insertAdjacentHTML('beforeend', `<tr><td>${bw}</td><td>${mass.toFixed(1)}</td></tr>`);
    }

    donBasisTBody.innerHTML = '';
    for(let d=1.0; d<=8.5+1e-9; d+=0.5){
      const basis = round1((d * 3.75) / area);
      donBasisTBody.insertAdjacentHTML('beforeend', `<tr><td>${d.toFixed(1)}</td><td>${basis.toFixed(1)}</td></tr>`);
    }
  }

  function exportCSV(){
    const rows = [];
    const w = toNum(wEl.value), h = toNum(hEl.value);
    const area = (w*h)/10000;

    const title = `${w} × ${h} cm 환산표`;
    rows.push(`"${title}"`);
    rows.push(`면적(㎡),${round4(area).toFixed(4)}`);
    rows.push('');

    rows.push('평량(g/㎡),질량(g)');
    document.querySelectorAll('#tblBasisToMass tbody tr').forEach(tr=>{
      const tds = tr.querySelectorAll('td');
      rows.push(`${tds[0].textContent},${tds[1].textContent}`);
    });
    rows.push('');

    rows.push('돈(몬메),평량(g/㎡)');
    document.querySelectorAll('#tblDonToBasis tbody tr').forEach(tr=>{
      const tds = tr.querySelectorAll('td');
      rows.push(`${tds[0].textContent},${tds[1].textContent}`);
    });

    const blob = new Blob(["\uFEFF" + rows.join('\r\n')], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = `${w}x${h}cm-환산표.csv`;
    document.body.appendChild(a); a.click();
    setTimeout(()=>{ URL.revokeObjectURL(url); a.remove(); }, 0);
  }

  $('#calc').addEventListener('click', calc);
  $('#csv').addEventListener('click', exportCSV);
  [wEl,hEl].forEach(el => el.addEventListener('keydown', e=>{
    if(e.key==='Enter') calc();
  }));
  calc();
})();
</script>
</body>
</html>



